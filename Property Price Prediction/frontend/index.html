<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vyom.AI - Property Price Prediction</title>
            <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
        <!-- Leaflet.js - Free, lightweight mapping library -->
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
        <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
        <!-- Leaflet Geocoder for search functionality -->
        <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder@3.0.0/dist/Control.Geocoder.css" />
        <script src="https://unpkg.com/leaflet-control-geocoder@3.0.0/dist/Control.Geocoder.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: #f8fafc;
            color: #1a202c;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header Section */
        .header {
            background: white;
            padding: 20px 0;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.5rem;
            font-weight: 700;
            color: #2d3748;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: #4299e1;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
        }

        .logo .ai-text {
            color: #48bb78;
        }

        .nav-links {
            display: flex;
            gap: 40px;
            align-items: center;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #718096;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .nav-link:hover, .nav-link.active {
            color: #4299e1;
        }

        /* Dropdown Menu Styles */
        .dropdown {
            position: relative;
            display: inline-block;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            background: white;
            min-width: 200px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            border-radius: 10px;
            z-index: 1001;
            top: 100%;
            left: 0;
            margin-top: 10px;
            border: 1px solid #e2e8f0;
            opacity: 0;
            transform: translateY(-10px);
            transition: opacity 0.3s ease, transform 0.3s ease;
        }

        .dropdown-content.show {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }

        .dropdown-content a {
            color: #4a5568;
            padding: 12px 16px;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.2s ease;
            border-bottom: 1px solid #f7fafc;
        }

        .dropdown-content a:last-child {
            border-bottom: none;
        }

        .dropdown-content a:hover {
            background-color: #f7fafc;
            color: #4299e1;
        }

        .dropdown-icon {
            margin-left: 5px;
            transition: transform 0.3s ease;
        }

        .dropdown.active .dropdown-icon {
            transform: rotate(180deg);
        }

        .nav-link i {
            font-size: 1.1rem;
        }

        .cta-button {
            background: #4299e1;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .cta-button:hover {
            background: #3182ce;
            transform: translateY(-1px);
        }

        /* Hero Section */
        .hero {
        background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('./assets/heroimage.jpg');
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
        padding: 120px 0 80px;
            text-align: center;
        color: white;
        position: relative;
        overflow: hidden;
    }

    .hero::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.3);
        z-index: 1;
    }

        .hero-content {
            position: relative;
            z-index: 3;
        }

        .hero h1 {
            font-size: 3.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            line-height: 1.2;
        }

        .hero .ai-highlight {
            color: #a0f1ea;
        }

        .hero p {
            font-size: 1.3rem;
            margin-bottom: 40px;
            opacity: 0.95;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .hero-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .hero-btn {
            padding: 16px 32px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
            display: inline-block;
        }

        .hero-btn.primary {
            background: #4299e1;
            color: white;
            border: none;
        }

        .hero-btn.primary:hover {
            background: #3182ce;
            transform: translateY(-2px);
        }

        .hero-btn.secondary {
            background: white;
            color: #2d3748;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .hero-btn.secondary:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            transform: translateY(-2px);
        }

        /* Why Choose Section */
        .features-section {
            background: white;
            padding: 80px 0;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .features-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1;
        }

        .features-section video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: 0;
        }

        .features-section h2 {
            font-size: 2.5rem;
            font-weight: 700;
            color: white;
            margin-bottom: 15px;
            position: relative;
            z-index: 2;
        }

        .features-section p {
            font-size: 1.2rem;
            color: #e2e8f0;
            margin-bottom: 60px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            position: relative;
            z-index: 2;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
            max-width: 1000px;
            margin: 0 auto;
            position: relative;
            z-index: 2;
        }

        .feature-card {
            background: white;
            padding: 40px 30px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            border: 1px solid #e2e8f0;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .feature-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.15);
            border-color: #4299e1;
        }

        .feature-icon {
            width: 80px;
            height: 80px;
            background: #ebf8ff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 25px;
            transition: all 0.3s ease;
        }

        .feature-card:hover .feature-icon {
            background: #4299e1;
            transform: scale(1.1);
        }

        .feature-icon i {
            font-size: 2rem;
            color: #4299e1;
            transition: all 0.3s ease;
        }

        .feature-card:hover .feature-icon i {
            color: white;
        }

        .feature-card h3 {
            font-size: 1.4rem;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 15px;
        }

        .feature-card p {
            font-size: 1rem;
            color: #718096;
            line-height: 1.6;
        }

        /* Services Section */
        .services-section {
            background: #f7fafc;
            padding: 80px 0;
        }

        .services-section h2 {
            font-size: 2.5rem;
            font-weight: 700;
            color: #2d3748;
            text-align: center;
            margin-bottom: 15px;
        }

        .services-section > .container > p {
            font-size: 1.1rem;
            color: #718096;
            text-align: center;
            margin-bottom: 50px;
        }

        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 40px;
            margin-top: 50px;
        }

        .service-card {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .service-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
            border-color: #4299e1;
        }

        .service-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #4299e1, #3182ce);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 25px;
            transition: all 0.3s ease;
        }

        .service-card:hover .service-icon {
            transform: scale(1.1);
        }

        .service-icon i {
            font-size: 2.5rem;
            color: white;
        }

        .service-card h3 {
            font-size: 1.6rem;
            font-weight: 700;
            color: #2d3748;
            text-align: center;
            margin-bottom: 15px;
        }

        .service-card p {
            font-size: 1rem;
            color: #718096;
            line-height: 1.6;
            text-align: center;
            margin-bottom: 25px;
        }

        .service-features {
            list-style: none;
            margin-bottom: 30px;
        }

        .service-features li {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 12px;
            color: #4a5568;
            font-size: 0.95rem;
        }

        .service-features li i {
            color: #48bb78;
            font-size: 0.9rem;
        }

        .service-btn {
            display: block;
            width: 100%;
            background: linear-gradient(135deg, #4299e1, #3182ce);
            color: white;
            text-decoration: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-weight: 600;
            text-align: center;
            transition: all 0.3s ease;
        }

        .service-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(66, 153, 225, 0.3);
        }

        /* Property Prediction Form Section */
        .prediction-section {
            background: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)), url('./assets/money.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            padding: 80px 0;
            position: relative;
        }

        .prediction-container {
            background: white;
            border-radius: 20px;
            padding: 50px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
            max-width: 800px;
            margin: 0 auto;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .prediction-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .prediction-header h2 {
            font-size: 2.5rem;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 15px;
        }

        .prediction-header .highlight {
            color: #48bb78;
        }

        .prediction-header p {
            font-size: 1.1rem;
            color: #718096;
        }

        .form-sections {
            display: grid;
            gap: 30px;
        }

        .form-section {
            border: 1px solid #e2e8f0;
            border-radius: 15px;
            padding: 25px;
            background: #fafbfc;
        }

        .form-section-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
            color: #2d3748;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .form-section-header i {
            color: #4299e1;
            font-size: 1.2rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #4a5568;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.2s ease;
            background: white;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #4299e1;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.1);
        }

        .form-group input::placeholder {
            color: #a0aec0;
        }

        /* Leaflet.js Styles */
        .map-container {
            position: relative;
            margin-bottom: 20px;
        }

        .map-search {
            position: absolute;
            top: 10px;
            left: 10px;
            z-index: 1000;
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            width: 350px;
        }

        .map-search input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .map-search button {
            width: 100%;
            padding: 10px;
            background: #4299e1;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
        }

        .map-search button:hover {
            background: #3182ce;
        }

        .map-info {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 1000;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            max-width: 300px;
            display: none;
        }

        .map-info.show {
            display: block;
        }

        .map-info h4 {
            margin: 0 0 15px 0;
            color: #2d3748;
            font-size: 18px;
        }

        .map-info p {
            margin: 8px 0;
            font-size: 14px;
            color: #4a5568;
        }

        .map-info .coordinates {
            background: #f7fafc;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            margin-top: 15px;
        }

        .map-info .price-data {
            background: #e6fffa;
            padding: 10px;
            border-radius: 4px;
            margin-top: 10px;
            border-left: 4px solid #38b2ac;
        }

        .map-info .price-data h5 {
            margin: 0 0 5px 0;
            color: #2c7a7b;
            font-size: 14px;
        }

        .map-info .price-data p {
            margin: 3px 0;
            font-size: 13px;
            color: #4a5568;
        }

        #map {
            height: 450px;
            width: 100%;
            border-radius: 12px;
            border: 2px solid #e2e8f0;
        }

        /* Leaflet specific styles */
        .leaflet-control-geocoder {
            width: 100% !important;
            max-width: none !important;
        }

        .leaflet-control-geocoder-form input {
            height: 45px !important;
            font-size: 14px !important;
            border-radius: 6px !important;
            border: 1px solid #e2e8f0 !important;
        }

        .leaflet-popup-content-wrapper {
            border-radius: 8px !important;
        }

        .leaflet-popup-content {
            margin: 15px !important;
            min-width: 200px;
        }

        .leaflet-popup-content h3 {
            margin: 0 0 10px 0;
            color: #2d3748;
            font-size: 16px;
        }

        .leaflet-popup-content p {
            margin: 5px 0;
            color: #4a5568;
            font-size: 14px;
        }

        .leaflet-control-zoom {
            border: none !important;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1) !important;
        }

        .leaflet-control-zoom a {
            background: white !important;
            color: #2d3748 !important;
            border: 1px solid #e2e8f0 !important;
        }

        .leaflet-control-zoom a:hover {
            background: #f7fafc !important;
        }

        .location-details {
            background: #f7fafc;
            padding: 20px;
            border-radius: 8px;
            margin-top: 15px;
            border: 1px solid #e2e8f0;
        }

        .location-details h4 {
            margin: 0 0 15px 0;
            color: #2d3748;
            font-size: 18px;
        }

        .location-details .location-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .location-details .info-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .location-details .info-item i {
            color: #4299e1;
            width: 18px;
        }

        .market-insights {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin-top: 15px;
        }

        .market-insights h4 {
            margin: 0 0 15px 0;
            color: white;
            font-size: 18px;
        }

        .market-insights .insight-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .market-insights .insight-item {
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 6px;
        }

        .market-insights .insight-item h5 {
            margin: 0 0 5px 0;
            font-size: 14px;
            opacity: 0.9;
        }

        .market-insights .insight-item p {
            margin: 0;
            font-size: 18px;
            font-weight: 600;
        }

        .amenities-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .amenity-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .amenity-item input[type="checkbox"] {
            width: auto;
            margin: 0;
            accent-color: #4299e1;
        }

        .amenity-item label {
            margin: 0;
            font-size: 0.95rem;
        }

        .predict-button {
            width: 100%;
            padding: 18px;
            background: #4299e1;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-top: 30px;
        }

        .predict-button:hover {
            background: #3182ce;
            transform: translateY(-2px);
        }

        .predict-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        /* Results Section */
        .results-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-top: 30px;
            display: none;
        }

        .results-section.show {
            display: block;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #4299e1;
        }

        .loading i {
            font-size: 3rem;
            margin-bottom: 20px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error {
            background: #fed7d7;
            color: #c53030;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            margin-bottom: 20px;
            border: 1px solid #feb2b2;
        }

        .prediction-result {
            text-align: center;
        }

        .price-display {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .price-display h2 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .price-display .price-range {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 15px;
        }

        .confidence-badge {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .insight-card {
            background: #f7fafc;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid #e2e8f0;
        }

        .insight-card h4 {
            color: #4299e1;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .insight-card p {
            font-size: 1.1rem;
            font-weight: 500;
            color: #2d3748;
        }

        /* Call to Action Section */
        .cta-section {
            background: white;
            padding: 80px 0;
            text-align: center;
        }

        .cta-card {
            background: white;
            border-radius: 20px;
            padding: 60px 40px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            max-width: 600px;
            margin: 0 auto;
        }

        .cta-card h2 {
            font-size: 2.5rem;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 20px;
        }

        .cta-card p {
            font-size: 1.2rem;
            color: #718096;
            margin-bottom: 30px;
        }

        .cta-button-large {
            background: #4299e1;
            color: white;
            padding: 18px 36px;
            border: none;
            border-radius: 10px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
            display: inline-block;
        }

        .cta-button-large:hover {
            background: #3182ce;
            transform: translateY(-2px);
        }

        /* Footer */
        .footer {
            background: #2d3748;
            color: white;
            padding: 60px 0 20px;
        }

        .footer-content {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr;
            gap: 40px;
            margin-bottom: 40px;
        }

        .footer-brand h3 {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.5rem;
            margin-bottom: 15px;
        }

        .footer-brand .ai-text {
            color: #48bb78;
        }

        .footer-brand p {
            color: #a0aec0;
            line-height: 1.6;
            max-width: 300px;
        }

        .footer-section h4 {
            color: white;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .footer-section a {
            display: block;
            color: #a0aec0;
            text-decoration: none;
            margin-bottom: 10px;
            transition: color 0.2s ease;
        }

        .footer-section a:hover {
            color: white;
        }

        .footer-bottom {
            border-top: 1px solid #4a5568;
            padding-top: 20px;
            text-align: center;
            color: #a0aec0;
            font-size: 0.9rem;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 20px;
            }

            .nav-links {
                gap: 20px;
            }
            
            .hero h1 {
                font-size: 2.5rem;
            }

            .hero-buttons {
                flex-direction: column;
                align-items: center;
            }

            .features-grid {
                grid-template-columns: 1fr;
            }

            .services-grid {
                grid-template-columns: 1fr;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .amenities-grid {
                grid-template-columns: 1fr;
            }

            .footer-content {
                grid-template-columns: 1fr;
                text-align: center;
            }

            .prediction-container {
                padding: 30px 20px;
            }
        }

        /* Currency Toggle */
        .currency-toggle {
            position: fixed;
            top: 100px;
            right: 20px;
            background: white;
            padding: 8px 12px;
            border-radius: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            z-index: 1000;
        }

        .currency-toggle button {
            background: none;
            border: none;
            padding: 4px 8px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s ease;
            margin: 0 2px;
        }

        .currency-toggle button.active {
            background: #4299e1;
            color: white;
        }

        /* Weather */
        .weather-section { background: #f8fafc; padding: 60px 0; }
        .weather-results { display: grid; grid-template-columns: 1fr; gap: 16px; }
        .weather-card { background: white; border: 1px solid #e2e8f0; border-radius: 12px; padding: 16px; }
        .weather-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 12px; }
        .weather-item { background: #f7fafc; border: 1px solid #e2e8f0; border-radius: 10px; padding: 12px; text-align: center; }
        .weather-item h5 { margin: 0 0 6px 0; color: #2d3748; font-size: 14px; }
        .weather-item p { margin: 0; font-size: 18px; font-weight: 600; color: #1a202c; }
    </style>
</head>
<body>
    <!-- Currency Toggle -->
    <div class="currency-toggle">
        <button class="active" onclick="setCurrency('INR')">₹ INR</button>
        <button onclick="setCurrency('USD')">$ USD</button>
            </div>

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <a href="#home" class="logo" style="text-decoration: none;">
                <div class="logo-icon">
                    <i class="fas fa-home"></i>
                </div>
                <span>Vyom.<span class="ai-text">AI</span></span>
            </a>
            
            <nav class="nav-links">
                <a href="#home" class="nav-link active">
                    <i class="fas fa-home"></i>
                    Home
                </a>
                <a href="#predict" class="nav-link">
                    <i class="fas fa-chart-line"></i>
                    Predict
                </a>
                <div class="dropdown">
                    <a href="#" class="nav-link">
                        <i class="fas fa-cogs"></i>
                        Tools
                        <i class="fas fa-chevron-down dropdown-icon"></i>
                    </a>
                    <div class="dropdown-content">
                        <a href="weather.html">
                            <i class="fas fa-cloud-sun"></i>
                            Live Weather
                        </a>
                        <a href="market-analytics.html">
                            <i class="fas fa-chart-bar"></i>
                            Market Analytics
                        </a>
                        <a href="location-insights.html">
                            <i class="fas fa-map-marked-alt"></i>
                            Location Insights
                        </a>
                        <a href="roi-calculator.html">
                            <i class="fas fa-calculator"></i>
                            ROI Calculator
                        </a>
                        <a href="property-reports.html">
                            <i class="fas fa-file-contract"></i>
                            Property Reports
                        </a>
                    </div>
                </div>
                <a href="#about" class="nav-link">
                    <i class="fas fa-info-circle"></i>
                    About
                </a>
                <a href="#faq" class="nav-link">
                    <i class="fas fa-question"></i>
                    FAQ
                </a>
                <a href="auth.html" class="nav-link">
                    <i class="fas fa-sign-in-alt"></i>
                    Login / Sign Up
                </a>
            </nav>


        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero" id="home">
            <div class="container">
            <div class="hero-content">
                <h1>Vyom.<span class="ai-highlight">AI</span></h1>
                <p>Property Price Predictions + Trusted Services</p>
                <p class="hero-subtitle">Get accurate property valuations and connect with verified professionals</p>
                <div class="hero-buttons">
                    <a href="auth.html" class="hero-btn primary">Explore Services</a>
                    <a href="#about" class="hero-btn secondary">Learn More</a>
                </div>
            </div>
        </div>
        </div>
    </section>
        
    <!-- Why Choose Section -->
    <section class="features-section" id="about">
        <video autoplay muted loop playsinline>
            <source src="./assets/backgroundvid.mp4" type="video/mp4">
        </video>
        <div class="container">
            <h2>Why Choose Vyom.AI?</h2>
            <p>Professional-grade property valuation technology accessible to everyone</p>
            
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-chart-line"></i>
                </div>
                    <h3>AI-Powered Predictions</h3>
                    <p>Advanced machine learning algorithms analyze market trends for accurate pricing.</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-shield-alt"></i>
                </div>
                    <h3>Trusted Results</h3>
                    <p>Built on comprehensive data from thousands of property transactions.</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-bolt"></i>
                </div>
                    <h3>Instant Analysis</h3>
                    <p>Get property valuations in seconds, not days or weeks.</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <h3>Expert Insights</h3>
                    <p>Backed by real estate professionals and market analysts.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Seller & Buyer System Section -->
    <section class="services-section" id="services">
        <div class="container">
            <h2>Trusted Property Services</h2>
            <p>Connect with verified professionals for all your property needs</p>
            
            <div class="services-grid">
                <div class="service-card">
                    <div class="service-icon">
                        <i class="fas fa-search"></i>
                    </div>
                    <h3>For Buyers</h3>
                    <p>Browse and hire verified construction companies, interior designers, and property brokers.</p>
                    <ul class="service-features">
                        <li><i class="fas fa-check"></i> Verified seller profiles</li>
                        <li><i class="fas fa-check"></i> Filter by location & experience</li>
                        <li><i class="fas fa-check"></i> Direct contact options</li>
                        <li><i class="fas fa-check"></i> Service reviews & ratings</li>
                    </ul>
                    <a href="auth.html" class="service-btn">Browse Services</a>
                </div>
                
                <div class="service-card">
                    <div class="service-icon">
                        <i class="fas fa-briefcase"></i>
                    </div>
                    <h3>For Sellers</h3>
                    <p>Create your professional profile and get verified to attract more clients.</p>
                    <ul class="service-features">
                        <li><i class="fas fa-check"></i> Professional profile creation</li>
                        <li><i class="fas fa-check"></i> Document verification system</li>
                        <li><i class="fas fa-check"></i> Verified badge display</li>
                        <li><i class="fas fa-check"></i> Client lead generation</li>
                    </ul>
                    <a href="auth.html" class="service-btn">Become a Seller</a>
                </div>
            </div>
        </div>
    </section>

    <!-- Property Prediction Section -->
    <section class="prediction-section" id="predict">
        <div class="container">
            <div class="prediction-container">
                <div class="prediction-header">
                    <h2>Property Price <span class="highlight">Prediction</span></h2>
                    <p>Fill in the details below to get an accurate price estimate.</p>
                </div>

                <form id="predictionForm">
                    <div class="form-sections">
                        <!-- Location Information -->
                        <div class="form-section">
                            <div class="form-section-header">
                                <i class="fas fa-map-marker-alt"></i>
                                Location Selection
                            </div>
                            <div class="form-group full-width">
                                <label>Select Property Location on Map *</label>
                                <div class="map-container">
                                                                        <div class="map-search">
                                        <input type="text" id="mapSearch" placeholder="Search for city, area, or address" onkeypress="if(event.key==='Enter') searchLocation()">
                                        <button type="button" onclick="searchLocation()">Search</button>
                                    </div>
                                    <div class="map-info" id="mapInfo">
                                        <h4>Selected Location</h4>
                                        <p id="locationName">Click on the map to select location</p>
                                        <p id="locationAddress"></p>
                                        <div class="coordinates" id="coordinates"></div>
                                        <div class="price-data" id="priceData" style="display: none;">
                                            <h5>Market Data</h5>
                                            <p id="avgPrice">Average Price: Loading...</p>
                                            <p id="pricePerSqft">Price/sq ft: Loading...</p>
                                            <p id="marketTrend">Trend: Loading...</p>
                                        </div>
                                    </div>
                                    <div id="map"></div>
                                </div>
                                                                    <div class="location-details" id="locationDetails" style="display: none;">
                                        <h4>Location Details</h4>
                                        <div class="location-info">
                                            <div class="info-item">
                                                <i class="fas fa-map-marker-alt"></i>
                                                <span id="selectedCity">City</span>
                                            </div>
                                            <div class="info-item">
                                                <i class="fas fa-globe"></i>
                                                <span id="selectedArea">Area</span>
                                            </div>
                                            <div class="info-item">
                                                <i class="fas fa-ruler-combined"></i>
                                                <span id="distanceFromCenter">Distance from center</span>
                                            </div>
                                            <div class="info-item">
                                                <i class="fas fa-star"></i>
                                                <span id="locationQuality">Location quality</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="market-insights" id="marketInsights" style="display: none;">
                                        <h4>Market Insights</h4>
                                        <div class="insight-grid">
                                            <div class="insight-item">
                                                <h5>Average Price</h5>
                                                <p id="marketAvgPrice">₹0</p>
                                            </div>
                                            <div class="insight-item">
                                                <h5>Price per sq ft</h5>
                                                <p id="marketPricePerSqft">₹0</p>
                                            </div>
                                            <div class="insight-item">
                                                <h5>Market Trend</h5>
                                                <p id="marketTrendValue">Stable</p>
                                            </div>
                                            <div class="insight-item">
                                                <h5>Demand Level</h5>
                                                <p id="demandLevel">Medium</p>
                                            </div>
                                        </div>
                                    </div>
                        </div>
                    </div>

                        <!-- Property Details -->
                        <div class="form-section">
                            <div class="form-section-header">
                                <i class="fas fa-home"></i>
                                Property Details
                            </div>
                            <div class="form-row">
                            <div class="form-group">
                                    <label for="propertyType">Property Type *</label>
                                    <select id="propertyType" required>
                                        <option value="">Select property type</option>
                                    <option value="apartment">Apartment</option>
                                    <option value="villa">Villa</option>
                                    <option value="townhouse">Townhouse</option>
                                        <option value="commercial">Commercial</option>
                                        <option value="penthouse">Penthouse</option>
                                </select>
                            </div>
                            <div class="form-group">
                                    <label for="squareFeet">Area (sq. ft.) *</label>
                                    <input type="number" id="squareFeet" placeholder="e.g. 1000" min="100" max="10000" required>
                            </div>
                            </div>
                            <div class="form-row">
                            <div class="form-group">
                                    <label for="bedrooms">Bedrooms</label>
                                    <select id="bedrooms">
                                        <option value="">Select</option>
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5+</option>
                                </select>
                            </div>
                            <div class="form-group">
                                    <label for="bathrooms">Bathrooms</label>
                                    <select id="bathrooms">
                                        <option value="">Select</option>
                                        <option value="1">1</option>
                                        <option value="1.5">1.5</option>
                                        <option value="2">2</option>
                                        <option value="2.5">2.5</option>
                                        <option value="3">3</option>
                                        <option value="3.5">3.5</option>
                                        <option value="4">4+</option>
                                    </select>
                            </div>
                            <div class="form-group">
                                    <label for="yearBuilt">Year Built</label>
                                    <input type="number" id="yearBuilt" placeholder="e.g. 2015" min="1950" max="2024">
                            </div>
                        </div>
                    </div>

                        <!-- Amenities -->
                        <div class="form-section">
                            <div class="form-section-header">
                                <i class="fas fa-star"></i>
                                Amenities
                            </div>
                            <div class="amenities-grid">
                                <div class="amenity-item">
                                    <input type="checkbox" id="hasParking">
                                    <label for="hasParking">Parking</label>
                            </div>
                                <div class="amenity-item">
                                    <input type="checkbox" id="hasPool">
                                    <label for="hasPool">Swimming Pool</label>
                            </div>
                                <div class="amenity-item">
                                    <input type="checkbox" id="hasGarden">
                                    <label for="hasGarden">Garden</label>
                            </div>
                                <div class="amenity-item">
                                    <input type="checkbox" id="hasGym">
                                    <label for="hasGym">Gym/Fitness Center</label>
                            </div>
                                <div class="amenity-item">
                                    <input type="checkbox" id="hasSecurity">
                                    <label for="hasSecurity">Security System</label>
                            </div>
                                <div class="amenity-item">
                                    <input type="checkbox" id="hasElevator">
                                    <label for="hasElevator">Elevator</label>
                        </div>
                                <div class="amenity-item">
                                    <input type="checkbox" id="hasBalcony">
                                    <label for="hasBalcony">Balcony/Terrace</label>
                    </div>
                                <div class="amenity-item">
                                    <input type="checkbox" id="hasAC">
                                    <label for="hasAC">Air Conditioning</label>
                    </div>
            </div>
        </div>
                    </div>

                    <button type="submit" class="predict-button">
                        <i class="fas fa-calculator"></i>
                        Predict Price
                    </button>
                </form>

                <!-- Results Section -->
                <div class="results-section" id="resultsSection">
                    <div id="resultsContent">
                        <!-- Results will be populated here -->
                </div>
                        </div>
                        </div>
                        </div>
    </section>

    <!-- Call to Action Section -->
    <section class="cta-section">
        <div class="container">
            <div class="cta-card">
                <h2>Ready to Get Started?</h2>
                <p>Join thousands of users who trust PropPredict AI for accurate property valuations.</p>
                <a href="#predict" class="cta-button-large">Predict Property Price</a>
            </div>
        </div>
    </section>

    <!-- Weather Section -->
    <section class="weather-section" id="weather">
        <div class="container">
            <div class="prediction-container" style="max-width:900px;">
                <div class="prediction-header">
                    <h2>Live <span class="highlight">Weather</span></h2>
                    <p>Get current conditions and a 5-day forecast for any city or your selected map location.</p>
                </div>
                <div class="form-sections">
                    <div class="form-section">
                        <div class="form-section-header">
                            <i class="fas fa-cloud-sun"></i>
                            Weather Search
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="weatherCity">City name</label>
                                <input type="text" id="weatherCity" placeholder="e.g. Dehradun, Mumbai, Delhi">
                            </div>
                            <div class="form-group">
                                <label>&nbsp;</label>
                                <button class="cta-button" type="button" onclick="handleWeatherSearch()" style="width:100%">Search Weather</button>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group full-width">
                                <button class="hero-btn secondary" type="button" onclick="handleUseMapLocation()" style="width:100%">
                                    <i class="fas fa-map-marker-alt"></i> Use Map Location
                                </button>
                            </div>
                        </div>
                        <div id="weatherResults" class="weather-results" style="margin-top:10px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer" id="faq">
        <div class="container">
            <div class="footer-content">
                <div class="footer-brand">
                    <h3>
                        <div class="logo-icon">
                            <i class="fas fa-home"></i>
                        </div>
                        PropPredict <span class="ai-text">AI</span>
                    </h3>
                    <p>Professional property price predictions powered by advanced AI technology.</p>
                </div>

                <div class="footer-section">
                    <h4>Quick Links</h4>
                    <a href="#predict">Price Prediction</a>
                    <a href="#about">How It Works</a>
                    <a href="#faq">FAQ</a>
                </div>

                <div class="footer-section">
                    <h4>Legal</h4>
                    <a href="#">Terms of Service</a>
                    <a href="#">Privacy Policy</a>
                    <a href="#">Contact Us</a>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>© 2024 PropPredict AI. All rights reserved.</p>
                    </div>
                    </div>
    </footer>

    <script>
        let currentCurrency = 'INR';
        const exchangeRate = 1; // Since we're using INR as base currency
        
        // Leaflet.js variables
        let map;
        let marker;
        let geocoder;
        let selectedLocation = {
            lat: 0,
            lng: 0,
            city: '',
            area: '',
            address: '',
            postalCode: '',
            state: '',
            country: ''
        };
        
        // Real-time property data with more cities and current market rates
        const cityPropertyData = {
            'Dehradun': {
                basePrice: 8500, // Updated per sq ft rates
                areas: {
                    'Rajpur Road': { multiplier: 1.3, trend: 'rising', demand: 'high', currentPrice: 11050 },
                    'Paltan Bazaar': { multiplier: 0.9, trend: 'stable', demand: 'medium', currentPrice: 7650 },
                    'Astley Hall': { multiplier: 1.6, trend: 'rising', demand: 'very high', currentPrice: 13600 },
                    'Clement Town': { multiplier: 1.2, trend: 'stable', demand: 'high', currentPrice: 10200 },
                    'Dalanwala': { multiplier: 1.4, trend: 'rising', demand: 'high', currentPrice: 11900 },
                    'Race Course': { multiplier: 1.8, trend: 'rising', demand: 'very high', currentPrice: 15300 },
                    'Rajpur': { multiplier: 1.1, trend: 'stable', demand: 'medium', currentPrice: 9350 }
                }
            },
            'Mumbai': {
                basePrice: 28000, // Updated rates
                areas: {
                    'Bandra West': { multiplier: 2.8, trend: 'rising', demand: 'very high', currentPrice: 78400 },
                    'Andheri West': { multiplier: 2.0, trend: 'rising', demand: 'high', currentPrice: 56000 },
                    'Powai': { multiplier: 1.8, trend: 'stable', demand: 'high', currentPrice: 50400 },
                    'Thane': { multiplier: 1.4, trend: 'rising', demand: 'medium', currentPrice: 39200 },
                    'Worli': { multiplier: 3.2, trend: 'rising', demand: 'very high', currentPrice: 89600 },
                    'Juhu': { multiplier: 2.5, trend: 'rising', demand: 'very high', currentPrice: 70000 }
                }
            },
            'Delhi': {
                basePrice: 20000, // Updated rates
                areas: {
                    'South Extension': { multiplier: 2.2, trend: 'rising', demand: 'very high', currentPrice: 44000 },
                    'Dwarka': { multiplier: 1.7, trend: 'stable', demand: 'high', currentPrice: 34000 },
                    'Rohini': { multiplier: 1.3, trend: 'stable', demand: 'medium', currentPrice: 26000 },
                    'Noida': { multiplier: 1.5, trend: 'rising', demand: 'high', currentPrice: 30000 },
                    'Gurgaon': { multiplier: 1.8, trend: 'rising', demand: 'very high', currentPrice: 36000 },
                    'Greater Noida': { multiplier: 1.2, trend: 'stable', demand: 'medium', currentPrice: 24000 }
                }
            },
            'Bangalore': {
                basePrice: 13500, // Updated rates
                areas: {
                    'Koramangala': { multiplier: 2.0, trend: 'rising', demand: 'very high', currentPrice: 27000 },
                    'Indiranagar': { multiplier: 2.2, trend: 'rising', demand: 'very high', currentPrice: 29700 },
                    'Whitefield': { multiplier: 1.6, trend: 'stable', demand: 'high', currentPrice: 21600 },
                    'Electronic City': { multiplier: 1.2, trend: 'stable', demand: 'medium', currentPrice: 16200 },
                    'Marathahalli': { multiplier: 1.4, trend: 'rising', demand: 'high', currentPrice: 18900 },
                    'HSR Layout': { multiplier: 1.8, trend: 'rising', demand: 'very high', currentPrice: 24300 }
                }
            },
            'Pune': {
                basePrice: 9500,
                areas: {
                    'Koregaon Park': { multiplier: 1.8, trend: 'rising', demand: 'very high', currentPrice: 17100 },
                    'Viman Nagar': { multiplier: 1.5, trend: 'rising', demand: 'high', currentPrice: 14250 },
                    'Hinjewadi': { multiplier: 1.3, trend: 'stable', demand: 'medium', currentPrice: 12350 },
                    'Baner': { multiplier: 1.4, trend: 'rising', demand: 'high', currentPrice: 13300 }
                }
            },
            'Hyderabad': {
                basePrice: 11000,
                areas: {
                    'Banjara Hills': { multiplier: 2.0, trend: 'rising', demand: 'very high', currentPrice: 22000 },
                    'Jubilee Hills': { multiplier: 1.9, trend: 'rising', demand: 'very high', currentPrice: 20900 },
                    'Gachibowli': { multiplier: 1.6, trend: 'stable', demand: 'high', currentPrice: 17600 },
                    'Madhapur': { multiplier: 1.3, trend: 'stable', demand: 'medium', currentPrice: 14300 }
                }
            },
            'Chennai': {
                basePrice: 12000,
                areas: {
                    'Adyar': { multiplier: 1.8, trend: 'rising', demand: 'very high', currentPrice: 21600 },
                    'T Nagar': { multiplier: 1.6, trend: 'stable', demand: 'high', currentPrice: 19200 },
                    'Anna Nagar': { multiplier: 1.4, trend: 'stable', demand: 'medium', currentPrice: 16800 },
                    'OMR': { multiplier: 1.2, trend: 'rising', demand: 'medium', currentPrice: 14400 }
                }
            }
        };

        // Smooth scrolling for navigation
        function scrollToSection(sectionId) {
            const element = document.getElementById(sectionId);
            if (element) {
                element.scrollIntoView({ behavior: 'smooth' });
            }
        }

        // Currency toggle
        function setCurrency(currency) {
            currentCurrency = currency;
            document.querySelectorAll('.currency-toggle button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            if (window.lastResults) {
                displayResults(window.lastResults);
            }
        }

        // Format currency
        function formatCurrency(amount, currency) {
            if (currency === 'INR') {
                return `₹${amount.toLocaleString('en-IN')}`;
            } else {
                return `$${amount.toLocaleString('en-US')}`;
            }
        }

        // Convert currency
        function convertCurrency(amount, fromCurrency, toCurrency) {
            if (fromCurrency === toCurrency) return amount;
            if (fromCurrency === 'USD' && toCurrency === 'INR') {
                return amount * exchangeRate;
            } else if (fromCurrency === 'INR' && toCurrency === 'USD') {
                return amount / exchangeRate;
            }
            return amount;
        }

        // Form submission
        document.getElementById('predictionForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            await predictPrice();
        });

        // Property price prediction
        async function predictPrice() {
            const submitBtn = document.querySelector('.predict-button');
            const resultsSection = document.getElementById('resultsSection');
            const resultsContent = document.getElementById('resultsContent');
            
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Predicting...';
            
            resultsSection.classList.add('show');
            resultsContent.innerHTML = `
                <div class="loading">
                    <i class="fas fa-spinner fa-spin"></i>
                    <p>Analyzing property details...</p>
                    <p>Calculating market value...</p>
                    </div>
            `;

            try {
                // Validate location selection
                if (selectedLocation.lat === 0 && selectedLocation.lng === 0) {
                    alert('Please select a location on the map first!');
                    return;
                }

                const formData = {
                    property_type: document.getElementById('propertyType').value,
                    square_feet: parseFloat(document.getElementById('squareFeet').value),
                    bedrooms: parseInt(document.getElementById('bedrooms').value) || 2,
                    bathrooms: parseFloat(document.getElementById('bathrooms').value) || 2,
                    year_built: parseInt(document.getElementById('yearBuilt').value) || 2020,
                    location_quality: document.getElementById('locationQuality').textContent.toLowerCase(),
                    distance_to_city: parseFloat(document.getElementById('distanceFromCenter').textContent),
                    has_parking: document.getElementById('hasParking').checked ? 1 : 0,
                    has_pool: document.getElementById('hasPool').checked ? 1 : 0,
                    has_garden: document.getElementById('hasGarden').checked ? 1 : 0,
                    has_gym: document.getElementById('hasGym').checked ? 1 : 0,
                    has_balcony: document.getElementById('hasBalcony').checked ? 1 : 0,
                    has_elevator: document.getElementById('hasElevator').checked ? 1 : 0,
                    has_security: document.getElementById('hasSecurity').checked ? 1 : 0,
                    has_fireplace: 0
                };

                const response = await fetch('http://localhost:5000/api/predict', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(formData)
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const result = await response.json();
                window.lastResults = result;
                displayResults(result);

            } catch (error) {
                console.error('Error:', error);
                resultsContent.innerHTML = `
                    <div class="error">
                        <i class="fas fa-exclamation-triangle"></i>
                        <h3>Connection Error</h3>
                        <p>Unable to connect to the prediction service.</p>
                        <p><strong>Error:</strong> ${error.message}</p>
                        <p><strong>Please:</strong></p>
                        <ul style="text-align: left; margin: 15px 0;">
                            <li>Make sure Python backend is running</li>
                            <li>Check if port 5000 is available</li>
                            <li>Restart the backend server</li>
                        </ul>
                    </div>
                `;
            } finally {
                submitBtn.disabled = false;
                submitBtn.innerHTML = '<i class="fas fa-calculator"></i> Predict Price';
            }
        }

        // Display results
        function displayResults(result) {
            const resultsContent = document.getElementById('resultsContent');
            
            const predictedPrice = convertCurrency(result.predicted_price, 'USD', currentCurrency);
            const lowPrice = convertCurrency(result.price_range.low, 'USD', currentCurrency);
            const highPrice = convertCurrency(result.price_range.high, 'USD', currentCurrency);
            const pricePerSqft = convertCurrency(result.insights.price_per_sqft, 'USD', currentCurrency);

            resultsContent.innerHTML = `
                <div class="prediction-result">
                    <div class="price-display">
                        <h2>${formatCurrency(predictedPrice, currentCurrency)}</h2>
                        <div class="price-range">
                            Range: ${formatCurrency(lowPrice, currentCurrency)} - ${formatCurrency(highPrice, currentCurrency)}
                    </div>
                        <div class="confidence-badge">
                            Confidence: ${(result.confidence * 100).toFixed(0)}%
                    </div>
                </div>

                    <div class="insights-grid">
                        <div class="insight-card">
                            <h4>Price per sq ft</h4>
                            <p>${formatCurrency(pricePerSqft, currentCurrency)}</p>
                    </div>
                        <div class="insight-card">
                            <h4>Price Category</h4>
                            <p>${result.insights.price_category}</p>
                    </div>
                        <div class="insight-card">
                            <h4>Market Position</h4>
                            <p>${result.insights.market_position}</p>
                </div>
                        <div class="insight-card">
                            <h4>Property Type</h4>
                            <p>${result.input_features.property_type.charAt(0).toUpperCase() + result.input_features.property_type.slice(1)}</p>
            </div>
        </div>

                    <div style="text-align: center; margin-top: 25px;">
                        <button onclick="downloadReport()" style="background: #805ad5; color: white; padding: 12px 24px; border: none; border-radius: 8px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.2s ease; display: inline-flex; align-items: center; gap: 8px;">
                            <i class="fas fa-download"></i>
                            Download Report
                        </button>
        </div>
                </div>
            `;
        }

        // Download report
        function downloadReport() {
            if (!window.lastResults) return;

            const result = window.lastResults;
            const predictedPrice = convertCurrency(result.predicted_price, 'USD', currentCurrency);
            const lowPrice = convertCurrency(result.price_range.low, 'USD', currentCurrency);
            const highPrice = convertCurrency(result.price_range.high, 'USD', currentCurrency);
            const pricePerSqft = convertCurrency(result.insights.price_per_sqft, 'USD', currentCurrency);

            const report = `
PROPERTY PRICE PREDICTION REPORT
================================

Property Details:
----------------
Type: ${result.input_features.property_type}
Area: ${result.input_features.square_feet} sq ft
Bedrooms: ${result.input_features.bedrooms}
Bathrooms: ${result.input_features.bathrooms}
Year Built: ${result.input_features.year_built}
Location Quality: ${result.input_features.location_quality}
Distance to City: ${result.input_features.distance_to_city} km

Amenities:
----------
Parking: ${result.input_features.has_parking ? 'Yes' : 'No'}
Pool: ${result.input_features.has_pool ? 'Yes' : 'No'}
Garden: ${result.input_features.has_garden ? 'Yes' : 'No'}
Gym: ${result.input_features.has_gym ? 'Yes' : 'No'}
Balcony: ${result.input_features.has_balcony ? 'Yes' : 'No'}
Elevator: ${result.input_features.has_elevator ? 'Yes' : 'No'}
Security: ${result.input_features.has_security ? 'Yes' : 'No'}

Prediction Results:
------------------
Predicted Price: ${formatCurrency(predictedPrice, currentCurrency)}
Price Range: ${formatCurrency(lowPrice, currentCurrency)} - ${formatCurrency(highPrice, currentCurrency)}
Price per sq ft: ${formatCurrency(pricePerSqft, currentCurrency)}
Confidence: ${(result.confidence * 100).toFixed(0)}%
Price Category: ${result.insights.price_category}
Market Position: ${result.insights.market_position}

Report Generated: ${new Date().toLocaleString('en-IN')}
Currency: ${currentCurrency}
            `;

            const blob = new Blob([report], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `property_prediction_report_${Date.now()}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }

        // Initialize Leaflet.js when page loads
        window.addEventListener('load', function() {
            initLeafletMap();
        });

        // Initialize Leaflet.js
        function initLeafletMap() {
            // Default to Dehradun coordinates
            const defaultLat = 30.3165;
            const defaultLng = 78.0322;
            
            // Create map with OpenStreetMap tiles
            map = L.map('map').setView([defaultLat, defaultLng], 12);
            
            // Add OpenStreetMap tiles
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '© OpenStreetMap contributors',
                maxZoom: 19
            }).addTo(map);
            
            // Add default marker
            marker = L.marker([defaultLat, defaultLng]).addTo(map);
            marker.bindPopup('<h3>Default Location</h3><p>Dehradun, Central</p>').openPopup();
            
            // Add click event to map
            map.on('click', function(e) {
                selectLocation(e.latlng);
            });
            
            // Set default location
            selectedLocation.lat = defaultLat;
            selectedLocation.lng = defaultLng;
            selectedLocation.city = 'Dehradun';
            selectedLocation.area = 'Central';
            updateLocationInfo();
            updateMarketInsights();
        }

        // Search for location using OpenStreetMap Nominatim API
        async function searchLocation() {
            const searchQuery = document.getElementById('mapSearch').value;
            if (!searchQuery) return;
            
            try {
                // Use OpenStreetMap Nominatim API for geocoding
                const response = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(searchQuery)}&limit=1&countrycodes=in`);
                const data = await response.json();
                
                if (data && data.length > 0) {
                    const location = data[0];
                    const lat = parseFloat(location.lat);
                    const lng = parseFloat(location.lon);
                    
                    // Update map view
                    map.setView([lat, lng], 15);
                    
                    // Update marker
                    if (marker) {
                        marker.setLatLng([lat, lng]);
                    } else {
                        marker = L.marker([lat, lng]).addTo(map);
                    }
                    
                    // Update selected location
                    selectedLocation.lat = lat;
                    selectedLocation.lng = lng;
                    selectedLocation.city = location.address?.city || location.address?.town || location.address?.village || 'Unknown';
                    selectedLocation.area = location.address?.suburb || location.address?.neighborhood || location.address?.road || 'Unknown';
                    selectedLocation.address = location.display_name;
                    
                    updateLocationInfo();
                    updateMarketInsights();
                    
                    // Update marker popup
                    marker.bindPopup(`<h3>Searched: ${searchQuery}</h3><p>${selectedLocation.city}, ${selectedLocation.area}</p>`).openPopup();
                } else {
                    alert('Location not found. Please try a different search term.');
                }
            } catch (error) {
                console.error('Error searching location:', error);
                alert('Error searching location. Please try again.');
            }
        }

        // Select location on map click
        function selectLocation(latlng) {
            const lat = latlng.lat;
            const lng = latlng.lng;
            
            // Update marker
            if (marker) {
                marker.setLatLng([lat, lng]);
            } else {
                marker = L.marker([lat, lng]).addTo(map);
            }
            
            // Reverse geocode to get address
            reverseGeocode(lat, lng);
        }

        // Reverse geocoding to get address from coordinates
        async function reverseGeocode(lat, lng) {
            try {
                const response = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}&zoom=18&addressdetails=1&countrycodes=in`);
                const data = await response.json();
                
                if (data && data.address) {
                    selectedLocation.lat = lat;
                    selectedLocation.lng = lng;
                    selectedLocation.city = data.address.city || data.address.town || data.address.village || 'Unknown';
                    selectedLocation.area = data.address.suburb || data.address.neighborhood || data.address.road || 'Unknown';
                    selectedLocation.address = data.display_name;
                    
                    updateLocationInfo();
                    updateMarketInsights();
                    
                    // Update marker popup
                    marker.bindPopup(`<h3>Selected Location</h3><p>${selectedLocation.city}, ${selectedLocation.area}</p>`).openPopup();
                }
            } catch (error) {
                console.error('Error reverse geocoding:', error);
                // Fallback to coordinates only
                selectedLocation.lat = lat;
                selectedLocation.lng = lng;
                selectedLocation.city = 'Unknown';
                selectedLocation.area = 'Unknown';
                selectedLocation.address = `Coordinates: ${lat.toFixed(6)}, ${lng.toFixed(6)}`;
                updateLocationInfo();
                updateMarketInsights();
            }
        }

        // Update location information display
        function updateLocationInfo() {
            const mapInfo = document.getElementById('mapInfo');
            const locationDetails = document.getElementById('locationDetails');
            
            // Update map info
            document.getElementById('locationName').textContent = selectedLocation.city;
            document.getElementById('locationAddress').textContent = selectedLocation.area;
            document.getElementById('coordinates').textContent = `${selectedLocation.lat.toFixed(6)}, ${selectedLocation.lng.toFixed(6)}`;
            
            // Update location details
            document.getElementById('selectedCity').textContent = selectedLocation.city;
            document.getElementById('selectedArea').textContent = selectedLocation.area;
            
            // Calculate distance from city center (Dehradun center)
            const centerLat = 30.3165;
            const centerLng = 78.0322;
            const distance = calculateDistance(selectedLocation.lat, selectedLocation.lng, centerLat, centerLng);
            
            document.getElementById('distanceFromCenter').textContent = `${distance.toFixed(1)} km`;
            
            // Determine location quality based on distance
            let quality = 'Medium';
            if (distance <= 5) quality = 'High';
            else if (distance > 15) quality = 'Low';
            document.getElementById('locationQuality').textContent = quality;
            
            // Show info panels
            mapInfo.classList.add('show');
            locationDetails.style.display = 'block';
        }

        // Calculate distance between two points (Haversine formula)
        function calculateDistance(lat1, lon1, lat2, lon2) {
            const R = 6371; // Earth's radius in kilometers
            const dLat = (lat2 - lat1) * Math.PI / 180;
            const dLon = (lon2 - lon1) * Math.PI / 180;
            const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
                      Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
                      Math.sin(dLon/2) * Math.sin(dLon/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
            return R * c;
        }

        // Update market insights based on selected location with real-time pricing
        function updateMarketInsights() {
            const marketInsights = document.getElementById('marketInsights');
            const priceData = document.getElementById('priceData');
            
            if (!selectedLocation.city || !cityPropertyData[selectedLocation.city]) {
                marketInsights.style.display = 'none';
                priceData.style.display = 'none';
                return;
            }
            
            const cityData = cityPropertyData[selectedLocation.city];
            const areaData = cityData.areas[selectedLocation.area] || cityData.areas['default'] || { 
                multiplier: 1.0, 
                trend: 'stable', 
                demand: 'medium',
                currentPrice: cityData.basePrice
            };
            
            // Use current market price if available, otherwise calculate from base price
            const currentPricePerSqft = areaData.currentPrice || (cityData.basePrice * areaData.multiplier);
            const avgPrice = currentPricePerSqft * 1000; // Assuming 1000 sq ft average property
            
            // Calculate price range (market variation)
            const priceVariation = 0.15; // 15% variation
            const minPrice = currentPricePerSqft * (1 - priceVariation);
            const maxPrice = currentPricePerSqft * (1 + priceVariation);
            
            // Update price data in map info
            document.getElementById('avgPrice').textContent = `Current Price: ₹${currentPricePerSqft.toLocaleString('en-IN')}/sq ft`;
            document.getElementById('pricePerSqft').textContent = `Range: ₹${minPrice.toLocaleString('en-IN')} - ₹${maxPrice.toLocaleString('en-IN')}`;
            document.getElementById('marketTrend').textContent = `Trend: ${areaData.trend}`;
            priceData.style.display = 'block';
            
            // Update market insights with real-time data
            document.getElementById('marketAvgPrice').textContent = `₹${currentPricePerSqft.toLocaleString('en-IN')}`;
            document.getElementById('marketPricePerSqft').textContent = `₹${avgPrice.toLocaleString('en-IN')}`;
            document.getElementById('marketTrendValue').textContent = areaData.trend.charAt(0).toUpperCase() + areaData.trend.slice(1);
            document.getElementById('demandLevel').textContent = areaData.demand.charAt(0).toUpperCase() + areaData.demand.slice(1);
            
            // Add real-time market data
            const realTimeData = getRealTimeMarketData(selectedLocation.city, selectedLocation.area);
            if (realTimeData) {
                document.getElementById('marketAvgPrice').textContent = `₹${realTimeData.currentPrice.toLocaleString('en-IN')}`;
                document.getElementById('marketPricePerSqft').textContent = `₹${realTimeData.avgPrice.toLocaleString('en-IN')}`;
                document.getElementById('marketTrendValue').textContent = realTimeData.trend;
                document.getElementById('demandLevel').textContent = realTimeData.demand;
            }
            
            marketInsights.style.display = 'block';
        }

        // Get real-time market data (simulated - you can integrate with real APIs)
        function getRealTimeMarketData(city, area) {
            // Simulate real-time data updates
            const now = new Date();
            const hour = now.getHours();
            
            // Simulate market fluctuations based on time
            let timeMultiplier = 1.0;
            if (hour >= 9 && hour <= 17) {
                timeMultiplier = 1.02; // 2% increase during business hours
            } else if (hour >= 18 && hour <= 22) {
                timeMultiplier = 1.01; // 1% increase during evening
            } else {
                timeMultiplier = 0.99; // 1% decrease during night
            }
            
            // Simulate weekly market trends
            const dayOfWeek = now.getDay();
            let weeklyMultiplier = 1.0;
            if (dayOfWeek === 1) weeklyMultiplier = 1.01; // Monday boost
            else if (dayOfWeek === 5) weeklyMultiplier = 1.02; // Friday boost
            else if (dayOfWeek === 0) weeklyMultiplier = 0.99; // Sunday dip
            
            if (cityPropertyData[city] && cityPropertyData[city].areas[area]) {
                const baseData = cityPropertyData[city].areas[area];
                const adjustedPrice = Math.round(baseData.currentPrice * timeMultiplier * weeklyMultiplier);
                
                return {
                    currentPrice: adjustedPrice,
                    avgPrice: adjustedPrice * 1000,
                    trend: baseData.trend,
                    demand: baseData.demand,
                    lastUpdated: now.toLocaleString('en-IN'),
                    marketActivity: hour >= 9 && hour <= 17 ? 'High' : 'Low'
                };
            }
            
            return null;
        }

        async function handleWeatherSearch() {
            const input = document.getElementById('weatherCity');
            const city = (input.value || '').trim();
            if (!city) { alert('Please enter a city name'); return; }
            try {
                const coords = await geocodeCity(city);
                if (!coords) { renderWeatherError('City not found'); return; }
                await renderWeather(coords.lat, coords.lon, coords.nameDisplay || city);
            } catch (e) {
                console.error(e);
                renderWeatherError('Unable to fetch weather');
            }
        }

        async function handleUseMapLocation() {
            if (!selectedLocation || !selectedLocation.lat || !selectedLocation.lng) {
                alert('Please select a location on the map first.');
                return;
            }
            await renderWeather(selectedLocation.lat, selectedLocation.lng, `${selectedLocation.city || 'Selected'} ${selectedLocation.area || ''}`.trim());
        }

        async function geocodeCity(cityName) {
            const url = `https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(cityName)}&count=1&language=en&format=json`;
            const res = await fetch(url);
            if (!res.ok) return null;
            const data = await res.json();
            if (!data || !data.results || data.results.length === 0) return null;
            const r = data.results[0];
            return { lat: r.latitude, lon: r.longitude, nameDisplay: `${r.name}${r.admin1 ? ', ' + r.admin1 : ''}${r.country ? ', ' + r.country : ''}` };
        }

        async function renderWeather(lat, lon, label) {
            const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,relative_humidity_2m,apparent_temperature,precipitation,weather_code,wind_speed_10m&hourly=temperature_2m&daily=temperature_2m_max,temperature_2m_min,precipitation_sum&timezone=auto`;
            const res = await fetch(url);
            if (!res.ok) { renderWeatherError('Weather API error'); return; }
            const data = await res.json();
            const resultsEl = document.getElementById('weatherResults');
            const current = data.current || {};
            const daily = (data.daily && data.daily.time) ? data.daily : null;

            let dailyCards = '';
            if (daily) {
                const days = daily.time.length;
                for (let i = 0; i < Math.min(days, 5); i++) {
                    const date = new Date(daily.time[i]).toLocaleDateString('en-IN', { weekday: 'short', month: 'short', day: 'numeric' });
                    const tmin = daily.temperature_2m_min[i];
                    const tmax = daily.temperature_2m_max[i];
                    const rain = daily.precipitation_sum[i];
                    dailyCards += `
                        <div class="weather-item">
                            <h5>${date}</h5>
                            <p>${Math.round(tmin)}° / ${Math.round(tmax)}°C</p>
                            <p style="font-size:12px; font-weight:500; color:#4a5568;">Rain: ${Math.round(rain)} mm</p>
                        </div>
                    `;
                }
            }

            resultsEl.innerHTML = `
                <div class="weather-card">
                    <h3 style="margin:0 0 10px 0; color:#2d3748;">Weather for ${label}</h3>
                    <div class="weather-grid" style="margin-bottom:12px;">
                        <div class="weather-item">
                            <h5>Temperature</h5>
                            <p>${current.temperature_2m != null ? Math.round(current.temperature_2m) + '°C' : '—'}</p>
                        </div>
                        <div class="weather-item">
                            <h5>Feels Like</h5>
                            <p>${current.apparent_temperature != null ? Math.round(current.apparent_temperature) + '°C' : '—'}</p>
                        </div>
                        <div class="weather-item">
                            <h5>Humidity</h5>
                            <p>${current.relative_humidity_2m != null ? Math.round(current.relative_humidity_2m) + '%' : '—'}</p>
                        </div>
                        <div class="weather-item">
                            <h5>Wind</h5>
                            <p>${current.wind_speed_10m != null ? Math.round(current.wind_speed_10m) + ' km/h' : '—'}</p>
                        </div>
                    </div>
                    <h4 style="margin:10px 0; color:#2d3748;">5-Day Forecast</h4>
                    <div class="weather-grid">${dailyCards}</div>
                </div>
            `;
        }

        function renderWeatherError(message) {
            const resultsEl = document.getElementById('weatherResults');
            resultsEl.innerHTML = `
                <div class="weather-card" style="background:#fff5f5; border-color:#fed7d7;">
                    <p style="color:#c53030; margin:0;">${message}</p>
                </div>
            `;
        }

        // Active navigation highlighting
        window.addEventListener('scroll', function() {
            const sections = document.querySelectorAll('section[id]');
            const navLinks = document.querySelectorAll('.nav-link');
            
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                if (pageYOffset >= sectionTop - 100) {
                    current = section.getAttribute('id');
                }
            });

            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === `#${current}`) {
                    link.classList.add('active');
                }
            });
        });

        // Dropdown menu functionality with improved timing
        document.addEventListener('DOMContentLoaded', function() {
            const dropdowns = document.querySelectorAll('.dropdown');
            
            dropdowns.forEach(dropdown => {
                const dropdownContent = dropdown.querySelector('.dropdown-content');
                let timeoutId;
                
                // Show dropdown on mouse enter
                dropdown.addEventListener('mouseenter', function() {
                    clearTimeout(timeoutId);
                    dropdown.classList.add('active');
                    dropdownContent.classList.add('show');
                });
                
                // Hide dropdown on mouse leave with delay
                dropdown.addEventListener('mouseleave', function() {
                    timeoutId = setTimeout(() => {
                        dropdown.classList.remove('active');
                        dropdownContent.classList.remove('show');
                    }, 500); // 500ms delay - much more user-friendly
                });
                
                // Keep dropdown open when hovering over content
                dropdownContent.addEventListener('mouseenter', function() {
                    clearTimeout(timeoutId);
                });
                
                dropdownContent.addEventListener('mouseleave', function() {
                    timeoutId = setTimeout(() => {
                        dropdown.classList.remove('active');
                        dropdownContent.classList.remove('show');
                    }, 500);
                });
            });
        });
    </script>
    
    <!-- Chatbot UI -->
    <style>
        .chatbot-fab {
            position: fixed;
            left: 20px;
            bottom: 20px;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: #4299e1;
            color: #ffffff;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
            cursor: pointer;
            z-index: 1002;
            border: none;
        }
        .chatbot-fab:hover { background: #3182ce; }
        .chatbot-window {
            position: fixed;
            left: 20px;
            bottom: 90px;
            width: 340px;
            max-height: 70vh;
            background: #ffffff;
            border-radius: 14px;
            box-shadow: 0 12px 30px rgba(0,0,0,0.18);
            display: none;
            flex-direction: column;
            overflow: hidden;
            z-index: 1002;
            border: 1px solid #e2e8f0;
        }
        .chatbot-header {
            background: linear-gradient(135deg, #4299e1, #3182ce);
            color: #ffffff;
            padding: 12px 14px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .chatbot-header .title { font-weight: 600; }
        .chatbot-messages {
            padding: 12px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .chat-msg {
            display: inline-block;
            max-width: 80%;
            padding: 8px 10px;
            border-radius: 10px;
            font-size: 0.95rem;
        }
        .chat-msg.bot {
            background: #f7fafc;
            color: #2d3748;
            align-self: flex-start;
            border: 1px solid #e2e8f0;
        }
        .chat-msg.user {
            background: #4299e1;
            color: #ffffff;
            align-self: flex-end;
        }
        .chatbot-input {
            display: flex;
            gap: 8px;
            border-top: 1px solid #e2e8f0;
            padding: 10px;
            background: #ffffff;
        }
        .chatbot-input input {
            flex: 1;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 10px 12px;
            font-size: 0.95rem;
        }
        .chatbot-input button {
            background: #4299e1;
            color: #ffffff;
            border: none;
            border-radius: 8px;
            padding: 0 14px;
            cursor: pointer;
        }
        .chatbot-input button:hover { background: #3182ce; }
        .chatbot-suggestions {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            padding: 8px 12px 0 12px;
        }
        .chatbot-suggestions button {
            background: #edf2f7;
            color: #2d3748;
            border: 1px solid #e2e8f0;
            border-radius: 16px;
            padding: 6px 10px;
            font-size: 12px;
            cursor: pointer;
        }
        .chatbot-suggestions button:hover { background: #e2e8f0; }
    </style>
    
    <button id="chatbotFab" class="chatbot-fab" title="Chat with Vyom.AI">
        <i class="fas fa-comment"></i>
    </button>
    <div id="chatbotWindow" class="chatbot-window">
        <div class="chatbot-header">
            <span class="title"><i class="fas fa-robot"></i> Vyom.AI Assistant</span>
            <button id="chatbotClose" style="background:none;border:none;color:#fff;cursor:pointer"><i class="fas fa-times"></i></button>
        </div>
        <div class="chatbot-suggestions">
            <button data-q="want to buy property">Want to buy property</button>
            <button data-q="want to check roi">Want to check ROI</button>
            <button data-q="check property prices by city">Check city prices</button>
            <button data-q="sample prediction">Sample prediction</button>
            <button data-q="live weather in dehradun">Live weather</button>
            <button data-q="usd inr rate">USD/INR</button>
        </div>
        <div id="chatbotMessages" class="chatbot-messages"></div>
        <div class="chatbot-input">
            <input id="chatbotInput" type="text" placeholder="Ask about prediction, health, features..." />
            <button id="chatbotSend"><i class="fas fa-paper-plane"></i></button>
        </div>
    </div>
    <script>
        (function() {
            const fab = document.getElementById('chatbotFab');
            const win = document.getElementById('chatbotWindow');
            const closeBtn = document.getElementById('chatbotClose');
            const messages = document.getElementById('chatbotMessages');
            const input = document.getElementById('chatbotInput');
            const sendBtn = document.getElementById('chatbotSend');
            const suggestionBar = document.querySelectorAll('.chatbot-suggestions button');

            function toggle(show) {
                win.style.display = show ? 'flex' : (win.style.display === 'flex' ? 'none' : 'flex');
                if (win.style.display === 'flex' && messages.childElementCount === 0) {
                    botSay("Hi! I'm your assistant. I can help you: check API health, show a sample prediction, and explain required fields. Try typing 'help'.");
                }
            }
            fab.addEventListener('click', () => toggle());
            closeBtn.addEventListener('click', () => toggle(false));
            sendBtn.addEventListener('click', () => handleSend());
            input.addEventListener('keypress', (e) => { if (e.key === 'Enter') handleSend(); });
            suggestionBar.forEach(b => b.addEventListener('click', () => { input.value = b.getAttribute('data-q'); handleSend(); }));

            function userSay(text) {
                const el = document.createElement('div');
                el.className = 'chat-msg user';
                el.textContent = text;
                messages.appendChild(el);
                messages.scrollTop = messages.scrollHeight;
            }
            function botSay(text) {
                const el = document.createElement('div');
                el.className = 'chat-msg bot';
                el.innerHTML = text;
                messages.appendChild(el);
                messages.scrollTop = messages.scrollHeight;
            }

            async function handleSend() {
                const text = (input.value || '').trim();
                if (!text) return;
                userSay(text);
                input.value = '';
                const lower = text.toLowerCase();

                try {
                    if (lower.includes('health')) {
                        botSay('Checking backend health...');
                        const res = await fetch('http://localhost:5000/api/health');
                        const data = await res.json();
                        botSay(`<strong>Status:</strong> ${data.status} <br/><strong>Model:</strong> ${data.model_status} <br/><small>${data.timestamp}</small>`);
                        return;
                    }
                    // Buyer intent
                    if (lower.includes('buy property')) {
                        botSay('Great! Tell me a city and approximate area in sq ft. Example: "Dehradun 1400"');
                        return;
                    }
                    // ROI intent
                    if (lower.includes('check roi') || lower.includes('roi')) {
                        botSay('To estimate ROI, provide purchase price, expected monthly rent, and years (e.g., "price 6000000 rent 30000 years 5").');
                        return;
                    }
                    // City price lookup intent
                    if (lower.includes('city prices') || lower.includes('check property prices')) {
                        botSay('Which city? Try: Dehradun, Mumbai, Delhi, Bangalore, Pune, Hyderabad, Chennai.');
                        return;
                    }
                    // Parse quick ROI input
                    if (lower.startsWith('price') && lower.includes('rent')) {
                        const price = parseFloat(lower.match(/price\s+(\d+[\d,\.]*)/)?.[1].replace(/[,]/g,'')||'0');
                        const rent = parseFloat(lower.match(/rent\s+(\d+[\d,\.]*)/)?.[1].replace(/[,]/g,'')||'0');
                        const years = parseFloat(lower.match(/years?\s+(\d+[\d,\.]*)/)?.[1]||'1');
                        if (price>0 && rent>0) {
                            const annualRent = rent*12;
                            const grossYield = (annualRent/price)*100;
                            const totalRent = annualRent*years;
                            botSay(`Gross yield: <strong>${grossYield.toFixed(2)}%</strong><br/>Total rent over ${years}y: <strong>₹${(totalRent).toLocaleString('en-IN')}</strong>`);
                        } else {
                            botSay('Please provide numbers like: price 6000000 rent 30000 years 5');
                        }
                        return;
                    }
                    // Parse city + optional area
                    const cityMatch = lower.match(/(dehradun|mumbai|delhi|bangalore|pune|hyderabad|chennai)/);
                    if (cityMatch) {
                        const city = cityMatch[1].replace(/\b\w/g, c => c.toUpperCase());
                        const areaMatch = lower.match(/(\d{3,5})/);
                        const areaSqft = areaMatch ? parseInt(areaMatch[1],10) : 1000;
                        try {
                            const priceInfo = window.cityPropertyData && window.cityPropertyData[city] ? window.cityPropertyData[city] : null;
                            if (priceInfo) {
                                const base = priceInfo.basePrice;
                                const avgPerSqft = base;
                                const est = avgPerSqft * areaSqft;
                                botSay(`Avg price in <strong>${city}</strong>: ₹${avgPerSqft.toLocaleString('en-IN')}/sq ft.<br/>For ~${areaSqft} sq ft, estimated: <strong>₹${est.toLocaleString('en-IN')}</strong>.`);
                            } else {
                                botSay(`I don't have live data for ${city} yet. Try one of the known cities.`);
                            }
                        } catch(e) { botSay('Unable to compute city prices.'); }
                        return;
                    }
                    if (lower.includes('sample') && lower.includes('prediction')) {
                        botSay('Running a sample prediction...');
                        const body = {
                            property_type: 'apartment',
                            square_feet: 1200,
                            bedrooms: 2,
                            bathrooms: 2,
                            year_built: 2018,
                            location_quality: 'medium',
                            distance_to_city: 8,
                            has_parking: 1, has_pool: 0, has_garden: 1, has_gym: 1,
                            has_balcony: 1, has_elevator: 0, has_security: 1, has_fireplace: 0
                        };
                        const res = await fetch('http://localhost:5000/api/predict', {
                            method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(body)
                        });
                        if (!res.ok) throw new Error('Backend returned ' + res.status);
                        const data = await res.json();
                        const price = new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(Math.round(data.predicted_price));
                        botSay(`Predicted price: <strong>${price}</strong><br/>Confidence: ${(data.confidence*100).toFixed(0)}%`);
                        return;
                    }
                    // Live weather (Open-Meteo, no key required)
                    if (lower.includes('live weather')) {
                        const city = (lower.split('live weather in')[1]||'dehradun').trim() || 'dehradun';
                        botSay(`Fetching weather for <strong>${city}</strong>...`);
                        try {
                            const geo = await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(city)}&count=1&language=en&format=json`);
                            const g = await geo.json();
                            if (!g.results || !g.results.length) { botSay('City not found.'); return; }
                            const { latitude, longitude, name } = g.results[0];
                            const w = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&current=temperature_2m,relative_humidity_2m,wind_speed_10m&timezone=auto`);
                            const d = await w.json();
                            const c = d.current || {};
                            botSay(`Weather in <strong>${name}</strong>: ${c.temperature_2m!=null?c.temperature_2m+'°C':'—'}, Humidity ${c.relative_humidity_2m??'—'}%, Wind ${c.wind_speed_10m??'—'} km/h`);
                        } catch(e){ botSay('Unable to fetch weather now.'); }
                        return;
                    }
                    // Simple USD/INR using exchangerate.host (no key)
                    if (lower.includes('usd') && lower.includes('inr')) {
                        botSay('Fetching USD/INR rate...');
                        try {
                            const resFx = await fetch('https://api.exchangerate.host/latest?base=USD&symbols=INR');
                            const fx = await resFx.json();
                            const rate = fx && fx.rates && fx.rates.INR ? fx.rates.INR : null;
                            if (rate) botSay(`1 USD ≈ <strong>₹${rate.toFixed(2)}</strong>`);
                            else botSay('Rate unavailable.');
                        } catch(e){ botSay('Unable to fetch FX rate.'); }
                        return;
                    }
                    if (lower.includes('help') || lower.includes('what can you do')) {
                        botSay(
                            'I can: <ul style="margin:6px 0 0 18px">' +
                            '<li>Suggest ideas for buying property</li>' +
                            '<li>Estimate ROI from rent and price</li>' +
                            '<li>Check city price averages</li>' +
                            '<li>Show live weather for a city</li>' +
                            '<li>Show current USD/INR rate</li>' +
                            '<li>Check backend health</li>' +
                            '<li>Run a sample prediction</li>' +
                            '</ul>'
                        );
                        return;
                    }
                    if (lower.includes('required') || lower.includes('fields')) {
                        botSay('Required fields: property_type, square_feet, bedrooms, bathrooms. Optional: year_built, location_quality, distance_to_city, and amenities.');
                        return;
                    }
                    botSay("Sorry, I didn't get that. Try 'check health' or 'sample prediction'.");
                } catch (e) {
                    botSay('Error: ' + (e && e.message ? e.message : 'Unknown'));
                }
            }
        })();
    </script>
</body>
</html>